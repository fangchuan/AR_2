  
#include "bsp_led.h"   

/*********************************************************************
*
*       Global data
*
**********************************************************************
*/
extern _Port port_1;
extern _Port port_2;
extern _Port port_3;
extern _Port port_4;
					
 /**
  * @brief  初始化控制LED的IO  ,换成寄存器的方式？
  * @param  无
  * @retval 无
  */
_Error LED_Config (_Led *led)
{		
	  if(led->id < 1 || led->id > 4)
			return ERROR_ID;
		else{
		uint8_t Pin;
		/*定义一个GPIO_InitTypeDef类型的结构体*/
		GPIO_InitTypeDef GPIO_InitStructure;

		/*开启GPIOC的外设时钟*/
//		RCC_APB2PeriphClockCmd( RCC_APB2Periph_GPIOC, ENABLE); 

		/*选择要控制的GPIOC引脚*/	
		switch(led->id)
		{
			case LED1:
				Pin = LED1_PIN;
//				GPIOC->CRL &= 0xfff3ffff;
			  port_1.dir = PORT_OUT;
				break;
			case LED2:
				Pin = LED2_PIN;
//				GPIOC->CRL &= 0xff3fffff;
			  port_2.dir = PORT_OUT;
				break;
			case LED3:
				Pin = LED3_PIN;
//				GPIOC->CRL &= 0xf3ffffff;
			  port_3.dir = PORT_OUT;
				break;
			case LED4:
				Pin = LED4_PIN;
//				GPIOC->CRL &= 0x3fffffff;
			  port_4.dir = PORT_OUT;
				break;
		}

		GPIO_InitStructure.GPIO_Pin  = Pin;
		/*设置引脚模式为通用推挽输出*/
		GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   

		/*设置引脚速率为50MHz */   
		GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; 

		/*调用库函数，初始化GPIOC*/
		GPIO_Init(GPIOC, &GPIO_InitStructure);	
		
		if(led->status)
			GPIO_SetBits(GPIOC,Pin);
//			digitalHi(GPIOC,Pin);
		else
			GPIO_ResetBits(GPIOC,Pin);
//			digitalLo(GPIOC,Pin);
		
		return NO_ERROR;
	}

}

_Error LED_Mannul(u8 id, u8 sw)
{
	  if(id < 1 || id > 4)
			return ERROR_ID;
		
		else{
				uint8_t Pin;
				/*定义一个GPIO_InitTypeDef类型的结构体*/
				GPIO_InitTypeDef GPIO_InitStructure;
				switch( id )
				{
					case LED1:
						Pin = LED1_PIN;
		//				GPIOC->CRL &= 0xfff3ffff;
					  port_1.dir = PORT_OUT;
						break;
					case LED2:
						Pin = LED2_PIN;
		//				GPIOC->CRL &= 0xff3fffff;
					  port_2.dir = PORT_OUT;
						break;
					case LED3:
						Pin = LED3_PIN;
		//				GPIOC->CRL &= 0xf3ffffff;
					  port_3.dir = PORT_OUT;
						break;
					case LED4:
						Pin = LED4_PIN;
		//				GPIOC->CRL &= 0x3fffffff;
					  port_4.dir = PORT_OUT;
						break;
				}

				GPIO_InitStructure.GPIO_Pin  = Pin;
				/*设置引脚模式为通用推挽输出*/
				GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   

				/*设置引脚速率为50MHz */   
				GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; 

				/*调用库函数，初始化GPIOC*/
				GPIO_Init(GPIOC, &GPIO_InitStructure);	
				
				if(sw)
					GPIO_SetBits(GPIOC,Pin);
		//			digitalHi(GPIOC,Pin);
				else
					GPIO_ResetBits(GPIOC,Pin);
		//			digitalLo(GPIOC,Pin);
				
				return NO_ERROR;
	}
}
/*********************************************END OF FILE**********************/
